title=Using JavaScript and Power Fx with DMN
date=2022-03-25
type=post
tags=blog
canonical=https://blog.kie.org/2022/03/using-javascript-and-power-fx-with-dmn.html
~~~~~~
<div class="row justify-content-center text-center py-3">
 <div class="col-lg-6">
  <div class="ratio ratio-16x9">
   <iframe src="https://www.youtube.com/embed/watch?v=-5VcMF40o_U" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
 </div>
</div>   
<p>In this short update, I want to share with you about an <em>experimental</em> feature to leverage the extensibility of the DMN specification to evaluate expressions using a plurality of expression languages, such as JavaScript, <a href="https://github.com/microsoft/Power-Fx" target="_blank" rel="noreferrer noopener">Power Fx</a>, and potentially many more!</p>   
<p>For the running example in this post, let's use the Body Mass Index (BMI) calculation described in the <a href="https://en.wikipedia.org/wiki/Body_mass_index" target="_blank" rel="noreferrer noopener">Wikipedia page</a>:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/CodeCogsEqn-2.png" alt=""> 
 </figure>
</div>   
<p>We can classify the result of the calculation, based on a standard Decision Table:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/image-7.png" alt=""> 
 </figure>
</div>   
<p>The decision table has been simplified if compared to the original article from Wikipedia, but that's irrelevant for the scope of this example.</p>   
<p>The overall DRG of the DMN model looks like this:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/image-8.png" alt=""> 
 </figure>
</div>   
<p>As we expect, "Mass" and "Height" are the InputDatas of the model; then we calculate the BMI with a first Decision node. Finally, we classify the calculated BMI value, accordingly to the Decision Table above.</p>   
<p>The last step is to provide the expression for the "Calculate BMI" decision node.</p>   
<p>For example, using Power Fx idioms:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/image-9-1024x504.png" alt=""> 
 </figure>
</div>   
<p>It would result in this final expression for the "Calculate BMI" decision node:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/image-10-1024x416.png" alt=""> 
 </figure>
</div>   
<p>In this case, the resulting DMN model evaluates using two expression languages: Power Fx for the first Decision, and the default (FEEL) for the Decision Table.</p>   
<p>For another example, we could use idiomatic JavaScript:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/Screenshot-2022-03-24-at-16.03.49-1024x396.png" alt=""> 
 </figure>
</div>   
<p>In this second case, the resulting DMN model evaluates using two expression languages: JavaScript for the first Decision, and again FEEL for the Decision Table.</p>   
<h2>Running the demo</h2>   
<p>We can now run the Kogito application.</p>   
<p>To demonstrate the BMI calculation, we naturally keep using the Swagger GUI:</p>   
<div class="row justify-content-center text-center">
 <figure class="figure"> 
  <img class="figure-img img-fluid" src="https://blog.kie.org/wp-content/uploads/2022/03/Screenshot-2022-03-24-at-16.12.46-1024x877.png" alt=""> 
 </figure>
</div>   
<p>If you are already accustomed in using DMN models with Kogito, you will have noticed there is basically no different in the way this system behaves from an external point of view.</p>   
<p>This is what we expect!</p>   
<p>We have now defined two DMN models, using a plurality of expression languages. However, our goal is to model our <em>decision services </em>in the most convenient and effective way possible. In this case, for example, we have used Power Fx, or JavaScript for some calculations.</p>   
<p>The code of this demo for the curious, is available <a href="https://github.com/tarilabs/dmn-js-powerfx-demo" target="_blank" rel="noreferrer noopener">here</a>.</p>   
<h2>Conclusions</h2>   
<p>Don't forget to check out the video linked above, for a live demonstration of this experimental capability!</p>   
<p>In this post, we have leveraged the extensibility of the DMN specification, in order to evaluate expressions using a plurality of expression languages. We have just used JavaScript and Power Fx with DMN!</p>   
<p>Questions?<br>Feedback?<br>Don't hesitate to let us know!</p>